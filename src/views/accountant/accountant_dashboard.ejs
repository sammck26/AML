<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Subscription Management</title>
    <link rel="stylesheet" type="text/css" href="/style.css"> 
</head>
<body>
    <%- include('../layout.ejs', { user }) %>
   
    <main class="content">
        <h2>Subscriptions</h2>

        <!-- Scrollable Table Container -->
        <div class="table-container-2">
            <table class="styled-table">
                <thead>
                  <tr>
                    <th>Full Name</th>
                    <th>Email</th>
                    <th>Plan</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Total Amount (Â£)</th>
                    <th>Branch</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <% subscriptions.forEach(subscription => { %>
                    <tr>
                      <td><%= subscription.full_name %></td>
                      <td><%= subscription.email %></td>
                      <td><%= subscription.plan || 'N/A' %></td>
                      <td><%= subscription.start_date ? new Date(subscription.start_date).toDateString() : 'N/A' %></td>
                      <td><%= subscription.end_date ? new Date(subscription.end_date).toDateString() : 'N/A' %></td>
                      <td><%= subscription.totalAmount || 'N/A' %></td>
                      <td><%= subscription.branch ? subscription.branch.name : 'Unknown' %></td>
                      <td>
                        <form action="/accountant/subscriptions/update/<%= subscription._id %>" method="post" style="display:inline;">
                          <button type="submit" style="padding: 5px 10px; margin-right: 5px; border: none; background-color: #6095dc; color: white; cursor: pointer; border-radius: 3px;">
                            Update
                          </button>
                        </form>
                        <form action="/accountant/subscriptions/delete/<%= subscription._id %>" method="post" style="display:inline;">
                          <button type="submit" onclick="return confirm('Are you sure you want to delete this subscription?')" 
                                  style="padding: 5px 10px; border: none; background-color: #f44336; color: white; cursor: pointer; border-radius: 3px;">
                            Delete
                          </button>
                        </form>
                      </td>
                    </tr>
                  <% }) %>
                </tbody>
              </table>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <p class="footer-number">07477045595</p>
            <div class="footer-links">
                <a href="https://instagram.com" target="_blank"><i class="fa-brands fa-instagram fa-xl"></i></a>
                <a href="https://facebook.com" target="_blank"><i class="fa-brands fa-facebook fa-xl"></i></a>
                <a href="https://x.com" target="_blank"><i class="fa-brands fa-x-twitter fa-xl"></i></a>
            </div>
        </div>
    </footer>
</body>
</html>
